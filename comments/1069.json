[
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/72044384",
    "html_url": "https://github.com/electron/electron/issues/1069#issuecomment-72044384",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1069",
    "id": 72044384,
    "user": {
      "login": "nantas",
      "id": 344547,
      "avatar_url": "https://avatars0.githubusercontent.com/u/344547?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nantas",
      "html_url": "https://github.com/nantas",
      "followers_url": "https://api.github.com/users/nantas/followers",
      "following_url": "https://api.github.com/users/nantas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nantas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nantas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nantas/subscriptions",
      "organizations_url": "https://api.github.com/users/nantas/orgs",
      "repos_url": "https://api.github.com/users/nantas/repos",
      "events_url": "https://api.github.com/users/nantas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nantas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-29T15:33:37Z",
    "updated_at": "2015-01-29T15:34:15Z",
    "body": "If I only use 'asar:' protocol for the starting page, and keep all other url reference with my custom protocol. I got the following error when load resources:\n\n``` javascript\nImported resource from origin 'myprotocol://' has been blocked from loading by Cross-Origin Resource Sharing policy: \nReceived an invalid response. Origin 'asar://' is therefore not allowed access.\n```\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/72079335",
    "html_url": "https://github.com/electron/electron/issues/1069#issuecomment-72079335",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1069",
    "id": 72079335,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2015-01-29T18:40:26Z",
    "updated_at": "2015-01-29T18:40:26Z",
    "body": "Yeah `Protocol.RequestFileJob` can not read asar archives, as work around you can use `fs` module to read the file and the use `protocol.RequestStringJob` to return the content.\n\n> If I only use 'asar:' protocol for the starting page, and keep all other url reference with my custom protocol. I got the following error when load resources:\n\nHave you turned on CSP in your `html` file?\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/72168641",
    "html_url": "https://github.com/electron/electron/issues/1069#issuecomment-72168641",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1069",
    "id": 72168641,
    "user": {
      "login": "nantas",
      "id": 344547,
      "avatar_url": "https://avatars0.githubusercontent.com/u/344547?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nantas",
      "html_url": "https://github.com/nantas",
      "followers_url": "https://api.github.com/users/nantas/followers",
      "following_url": "https://api.github.com/users/nantas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nantas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nantas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nantas/subscriptions",
      "organizations_url": "https://api.github.com/users/nantas/orgs",
      "repos_url": "https://api.github.com/users/nantas/repos",
      "events_url": "https://api.github.com/users/nantas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nantas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-30T08:25:10Z",
    "updated_at": "2015-01-30T08:26:21Z",
    "body": "I added \n\n``` html\n<meta http-equiv=\"Content-Security-Policy\" content=\"default-src myprotocol: 'unsafe-inline'\" >\n```\n\nIn my starting html page.\n\nBut still got the same error:\n\n``` plain\nImported resource from origin 'myprotocol://' has been blocked from loading by Cross-Origin Resource Sharing policy: \nReceived an invalid response. Origin 'asar://' is therefore not allowed access.\n```\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/72185160",
    "html_url": "https://github.com/electron/electron/issues/1069#issuecomment-72185160",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1069",
    "id": 72185160,
    "user": {
      "login": "nantas",
      "id": 344547,
      "avatar_url": "https://avatars0.githubusercontent.com/u/344547?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nantas",
      "html_url": "https://github.com/nantas",
      "followers_url": "https://api.github.com/users/nantas/followers",
      "following_url": "https://api.github.com/users/nantas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nantas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nantas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nantas/subscriptions",
      "organizations_url": "https://api.github.com/users/nantas/orgs",
      "repos_url": "https://api.github.com/users/nantas/repos",
      "events_url": "https://api.github.com/users/nantas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nantas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-30T11:00:07Z",
    "updated_at": "2015-01-30T11:00:07Z",
    "body": "I find no way to solve the cross-protocol reference issue stated above, so I can only go on with changing all resource protocols to \"asar\" in my html files.\n\nNow I'm trying to use `protocol.RequestStringJob` inside registerProtocol to handle resources in asar package like this:\n\n``` javascript\n    Protocol.registerProtocol('asar', function(request) {\n        //work out file path\n        var fileContent = fs.readFileSync(filePath);\n        return new Protocol.RequestStringJob({\n            mimeType: Mime.lookup(file),\n            data: fileContent\n        });\n    });\n```\n\nIt works for html and css files, I can load them from asar correctly. But any image files are not displaying. It doesn't report any \"Failed to load resource\" error so my guess is that the request is proceeded but somehow the content cannot be displayed. Is it because the default setting `charset: 'UTF-8'` gets in the way of displaying images? @zcbenz \n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/72270971",
    "html_url": "https://github.com/electron/electron/issues/1069#issuecomment-72270971",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1069",
    "id": 72270971,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2015-01-30T21:11:32Z",
    "updated_at": "2015-01-30T21:11:32Z",
    "body": "It is because `RequestStringJob` is not capable of processing binary data, #566 did propose a way to fix this but it is not implemented yet.\n\nI'll fix the custom protocol not loading under `asar://`, it is affecting Atom too.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/72801131",
    "html_url": "https://github.com/electron/electron/issues/1069#issuecomment-72801131",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1069",
    "id": 72801131,
    "user": {
      "login": "nantas",
      "id": 344547,
      "avatar_url": "https://avatars0.githubusercontent.com/u/344547?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nantas",
      "html_url": "https://github.com/nantas",
      "followers_url": "https://api.github.com/users/nantas/followers",
      "following_url": "https://api.github.com/users/nantas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nantas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nantas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nantas/subscriptions",
      "organizations_url": "https://api.github.com/users/nantas/orgs",
      "repos_url": "https://api.github.com/users/nantas/repos",
      "events_url": "https://api.github.com/users/nantas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nantas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-04T07:08:19Z",
    "updated_at": "2015-02-04T07:08:19Z",
    "body": "I tested atom-shell v0.21.1, without `asar:` protocol, it didn't complain about cross-origin policy anymore.\nBut my custom protocol still cannot load resource from asar package due to `protocol.RequestFileJob` does not work for files inside asar, and lack of `RequestBufferJob` implemented.\n\nI guess the example in [Application Packaging Documentation](https://github.com/atom/atom-shell/blob/master/docs/tutorial/application-packaging.md):\n\n``` js\napp.on('will-finish-launching', function() {\n    var protocol = require('protocol');\n    protocol.registerProtocol('atom', function(request) {\n      var url = request.url.substr(7)\n      return new protocol.RequestFileJob(path.normalize(__dirname + '/' + url));\n    });\n});\n```\n\nWill not work for asar package, can you confirm that?\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/72905765",
    "html_url": "https://github.com/electron/electron/issues/1069#issuecomment-72905765",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1069",
    "id": 72905765,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2015-02-04T18:05:31Z",
    "updated_at": "2015-02-04T18:05:31Z",
    "body": "Yeah I can confirm it, we still need a way to load asar resources in custom protocols.\n"
  }
]