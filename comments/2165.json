[
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/120210196",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-120210196",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 120210196,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2015-07-10T03:05:38Z",
    "updated_at": "2015-07-10T03:05:38Z",
    "body": "I tried to run\n\n``` js\n        Promise.resolve().then(function(){\n            console.log(`${new Date()} : Promise.resolve.`);\n        },function(){\n            console.log(`${new Date()} : Promise.reject.`);\n        });\n```\n\nin Chrome's devtools, it prints:\n\n``` js\nPromise {[[PromiseStatus]]: \"pending\", [[PromiseValue]]: undefined}\n```\n\nAnd in Electron it prints the exactly the same thing.\n\n> 2.\"--disable-gpu\" doesn't work\n\nCan you open url `chrome://gpu` in your app and paste the result?\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/120254735",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-120254735",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 120254735,
    "user": {
      "login": "cnjon",
      "id": 10810189,
      "avatar_url": "https://avatars3.githubusercontent.com/u/10810189?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cnjon",
      "html_url": "https://github.com/cnjon",
      "followers_url": "https://api.github.com/users/cnjon/followers",
      "following_url": "https://api.github.com/users/cnjon/following{/other_user}",
      "gists_url": "https://api.github.com/users/cnjon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cnjon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cnjon/subscriptions",
      "organizations_url": "https://api.github.com/users/cnjon/orgs",
      "repos_url": "https://api.github.com/users/cnjon/repos",
      "events_url": "https://api.github.com/users/cnjon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cnjon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-10T06:53:12Z",
    "updated_at": "2015-07-10T06:53:12Z",
    "body": "1.\n\n``` javascript\nmainWindow.webContents.on('did-finish-load',function(){\n    try{\n        console.log(`did-finish-load.`);\n\n        console.log(`Start Promise.`);\n        Promise.resolve().then(function(){\n            console.log(`Promise.resolve.`);\n        },function(){\n            console.log(`Promise.reject.`);\n        });\n        console.log(`End Promise.`);\n    }catch(ex){\n        console.log(`${new Date()} : error : ${ex}.`);\n    }\n  });\n```\n\nIn v0.28.3,it prints:\n![0 28 3](https://cloud.githubusercontent.com/assets/10810189/8613414/832f1d0c-2711-11e5-8694-eca7ff261f7b.png)\nThe same code,In v0.29.2,it prints:\n![0 29 2](https://cloud.githubusercontent.com/assets/10810189/8613426/987da750-2711-11e5-8678-873e4e27b41a.png)\n\n2.\n\n``` javascript\napp.commandLine.appendSwitch('--disable-gpu');\n```\n\nIn v0.28.3,it has 2 processes:\n![0 28 3-gpu](https://cloud.githubusercontent.com/assets/10810189/8613582/280f8c0c-2713-11e5-89fa-b44b976a4eeb.png)\nIn v0.29.2,it has 3 processes:\n![0 29 2-gpu](https://cloud.githubusercontent.com/assets/10810189/8613592/3f27d11a-2713-11e5-91d2-de347efb9828.png)\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/120301363",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-120301363",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 120301363,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2015-07-10T08:37:23Z",
    "updated_at": "2015-07-10T08:37:23Z",
    "body": "I downloaded the binaries from the Releases page and tested the x64 and ia32 binaries on a Windows 8.1 machine, and I can not reproduce what you said.\n\nFor the first problem, I tested by running this script:\n\n```\n    try{\n        console.log(`${new Date()} : did-finish-load.`);\n\n        console.log(`${new Date()} : Promise.`);\n        Promise.resolve().then(function(){\n            console.log(`${new Date()} : Promise.resolve.`);\n        },function(){\n            console.log(`${new Date()} : Promise.reject.`);\n        });\n        console.log(`${new Date()} : End Promise.`);\n    }catch(ex){\n        console.log(`${new Date()} : error : ${ex}.`);\n    }\n```\n\nAnd this command\n\n```\n./electron-v0.29.2-win32-x64/electron.exe test.js\n```\n\nprints\n\n```\n[3068:0710/093107:INFO:CONSOLE(0)] did-finish-load.\n[3068:0710/093107:INFO:CONSOLE(0)] Start Promise.\n[3068:0710/093107:INFO:CONSOLE(0)] End Promise.\n[3068:0710/093107:INFO:CONSOLE(0)] Promise.resolve.\n```\n\nFor the second problem and I tested in this way:\n\n```\n./electron-v0.29.2-win32-x64/electron.exe --disable-gpu\n```\n\nAnd there is no GPU process.\n\nPlease provide reproducible example apps.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/120394768",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-120394768",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 120394768,
    "user": {
      "login": "LeMoussel",
      "id": 1816573,
      "avatar_url": "https://avatars3.githubusercontent.com/u/1816573?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LeMoussel",
      "html_url": "https://github.com/LeMoussel",
      "followers_url": "https://api.github.com/users/LeMoussel/followers",
      "following_url": "https://api.github.com/users/LeMoussel/following{/other_user}",
      "gists_url": "https://api.github.com/users/LeMoussel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LeMoussel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LeMoussel/subscriptions",
      "organizations_url": "https://api.github.com/users/LeMoussel/orgs",
      "repos_url": "https://api.github.com/users/LeMoussel/repos",
      "events_url": "https://api.github.com/users/LeMoussel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LeMoussel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-10T11:57:24Z",
    "updated_at": "2015-07-10T11:57:24Z",
    "body": "Like @zcbenz , Tested on Windows 7 with  ia32 binaries (electron-v0.29.1-win32-ia32).\n`electron-v0.29.1-win32-ia32\\electron.exe --disable-gpu`\nThere is no GPU process, only 2  processes.\n\nAnd with this code script\n\n``` javascript\nvar app = require('app');\napp.commandLine.appendSwitch('--disable-gpu');\napp.on('ready', function() {\n  // Your code here\n});\n```\n\nIt has 2 processes.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/120395714",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-120395714",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 120395714,
    "user": {
      "login": "LeMoussel",
      "id": 1816573,
      "avatar_url": "https://avatars3.githubusercontent.com/u/1816573?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LeMoussel",
      "html_url": "https://github.com/LeMoussel",
      "followers_url": "https://api.github.com/users/LeMoussel/followers",
      "following_url": "https://api.github.com/users/LeMoussel/following{/other_user}",
      "gists_url": "https://api.github.com/users/LeMoussel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LeMoussel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LeMoussel/subscriptions",
      "organizations_url": "https://api.github.com/users/LeMoussel/orgs",
      "repos_url": "https://api.github.com/users/LeMoussel/repos",
      "events_url": "https://api.github.com/users/LeMoussel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LeMoussel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-10T12:04:36Z",
    "updated_at": "2015-07-10T12:04:36Z",
    "body": "For the first problem I tested the @zcbenz script on Windows 7 with ia32 binaries (electron-v0.29.1-win32-ia32).\nPrint same result that @zcbenz script.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/120593077",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-120593077",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 120593077,
    "user": {
      "login": "cnjon",
      "id": 10810189,
      "avatar_url": "https://avatars3.githubusercontent.com/u/10810189?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cnjon",
      "html_url": "https://github.com/cnjon",
      "followers_url": "https://api.github.com/users/cnjon/followers",
      "following_url": "https://api.github.com/users/cnjon/following{/other_user}",
      "gists_url": "https://api.github.com/users/cnjon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cnjon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cnjon/subscriptions",
      "organizations_url": "https://api.github.com/users/cnjon/orgs",
      "repos_url": "https://api.github.com/users/cnjon/repos",
      "events_url": "https://api.github.com/users/cnjon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cnjon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-11T07:39:02Z",
    "updated_at": "2015-07-11T07:41:33Z",
    "body": "I tested on Windows 7 x64, with ia32 binaries (electron-v0.29.2-win32-ia32) & x64 binaries (electron-v0.29.2-win32-x64),download from https://npm.taobao.org/mirrors/electron/0.29.2/\n![sys](https://cloud.githubusercontent.com/assets/10810189/8632886/fa9de8b2-27e0-11e5-92d8-9bdf0d53b595.png)\n\nI tested this code on another PC, print same result.\n\nmain.js:\n\n``` javascript\nvar app = require('app');\nvar BrowserWindow = require('browser-window');\n\napp.on('window-all-closed', function() {\n  app.quit();\n});\n\nvar mainWindow;\n\napp.commandLine.appendSwitch('--disable-gpu');\napp.on('ready', function() {\n  mainWindow = new BrowserWindow({\n    width: 800,\n    height: 600\n  });\n  mainWindow.webContents.on('did-finish-load',function(){\n    try{\n        console.log(`did-finish-load.`);\n        console.log(`Start Promise.`);\n        Promise.resolve().then(function(){\n            console.log(`Promise.resolve.`);\n        },function(){\n            console.log(`Promise.reject.`);\n        });\n        console.log(`End Promise.`);\n    }catch(ex){\n        console.log(`error : ${ex.message}.`);\n    }\n  });\n  mainWindow.loadUrl('file://' + __dirname + '/index.html');\n  mainWindow.focus();\n});\n```\n\nI don't know why...\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/120755555",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-120755555",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 120755555,
    "user": {
      "login": "NIM-Pro",
      "id": 5101482,
      "avatar_url": "https://avatars0.githubusercontent.com/u/5101482?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NIM-Pro",
      "html_url": "https://github.com/NIM-Pro",
      "followers_url": "https://api.github.com/users/NIM-Pro/followers",
      "following_url": "https://api.github.com/users/NIM-Pro/following{/other_user}",
      "gists_url": "https://api.github.com/users/NIM-Pro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NIM-Pro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NIM-Pro/subscriptions",
      "organizations_url": "https://api.github.com/users/NIM-Pro/orgs",
      "repos_url": "https://api.github.com/users/NIM-Pro/repos",
      "events_url": "https://api.github.com/users/NIM-Pro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NIM-Pro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-12T19:27:42Z",
    "updated_at": "2015-07-12T19:38:55Z",
    "body": "A similar problem.\nVersion: 0.29.2.\nOS: Windows 7 x64.\n\nCode:\n\n``` js\nfunction Message(text) {\n    var win=createWindow('application://index.html')\n    return new Promise(function(resolve,reject) {\n        win.webContents.once('ipc-message', function(e, args) {\n            console.log('ipc-message', args)\n            if (args[0]==='resolve') {\n                console.log('args[0]===\"resolve\" => true')\n                resolve(args[1])\n                //win.close()\n            }\n        })\n    })\n}\n\napp.on('ready', function() {\n    Message('azaza')\n    .then(function(value) {\n        console.log('Resolved',value)\n    })\n    .catch(function(e) {\n        console.log(e.stack||e)\n    })\n})\n```\n\nOutput:\n\n```\n[5216:0713/022619:INFO:CONSOLE(0)] ipc-message [ 'resolve', 'Work, please!' ]\n[5216:0713/022619:INFO:CONSOLE(0)] args[0]===\"resolve\" => true\n```\n\nI was able to normalize the promises with the following code:\n\n``` js\nsetInterval(function() {\n    new Promise(function(resolve) {\n        resolve()\n    })\n}, 1000)\n```\n\nHowever, I do not think that the use of this solution in real projects is a good idea.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/120775736",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-120775736",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 120775736,
    "user": {
      "login": "cnjon",
      "id": 10810189,
      "avatar_url": "https://avatars3.githubusercontent.com/u/10810189?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cnjon",
      "html_url": "https://github.com/cnjon",
      "followers_url": "https://api.github.com/users/cnjon/followers",
      "following_url": "https://api.github.com/users/cnjon/following{/other_user}",
      "gists_url": "https://api.github.com/users/cnjon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cnjon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cnjon/subscriptions",
      "organizations_url": "https://api.github.com/users/cnjon/orgs",
      "repos_url": "https://api.github.com/users/cnjon/repos",
      "events_url": "https://api.github.com/users/cnjon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cnjon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-13T00:18:21Z",
    "updated_at": "2015-07-13T00:18:21Z",
    "body": "@NIM-Pro But,it works fine in electron v0.28.x,just 0.29.x has this problem.\n\n@zcbenz  help me,please!\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/122031771",
    "html_url": "https://github.com/electron/electron/issues/2165#issuecomment-122031771",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/2165",
    "id": 122031771,
    "user": {
      "login": "tengyifei",
      "id": 2877531,
      "avatar_url": "https://avatars0.githubusercontent.com/u/2877531?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tengyifei",
      "html_url": "https://github.com/tengyifei",
      "followers_url": "https://api.github.com/users/tengyifei/followers",
      "following_url": "https://api.github.com/users/tengyifei/following{/other_user}",
      "gists_url": "https://api.github.com/users/tengyifei/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tengyifei/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tengyifei/subscriptions",
      "organizations_url": "https://api.github.com/users/tengyifei/orgs",
      "repos_url": "https://api.github.com/users/tengyifei/repos",
      "events_url": "https://api.github.com/users/tengyifei/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tengyifei/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-16T17:40:37Z",
    "updated_at": "2015-07-16T17:40:37Z",
    "body": "Both 0.29.1 and 0.29.2 have this problem on OS X. Similar to @NIM-Pro 's suggestion, wrapping the promise with `setTimeout`, `setInterval`, or `process.nextTick` works around the issue. Heck it's even fixed when there is `console.log` statement preceding the `.then()` call, which I think also delays it into the next iteration of the event loop.\n\nIt seems that promises only malfunction when they are inside an event listener in the main process.\n"
  }
]