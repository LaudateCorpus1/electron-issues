[
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/284740084",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-284740084",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 284740084,
    "user": {
      "login": "MarshallOfSound",
      "id": 6634592,
      "avatar_url": "https://avatars0.githubusercontent.com/u/6634592?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarshallOfSound",
      "html_url": "https://github.com/MarshallOfSound",
      "followers_url": "https://api.github.com/users/MarshallOfSound/followers",
      "following_url": "https://api.github.com/users/MarshallOfSound/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarshallOfSound/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarshallOfSound/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarshallOfSound/subscriptions",
      "organizations_url": "https://api.github.com/users/MarshallOfSound/orgs",
      "repos_url": "https://api.github.com/users/MarshallOfSound/repos",
      "events_url": "https://api.github.com/users/MarshallOfSound/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarshallOfSound/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-07T14:41:51Z",
    "updated_at": "2017-03-07T14:41:51Z",
    "body": "@ButzYung Are you using babel?"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/284773549",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-284773549",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 284773549,
    "user": {
      "login": "ButzYung",
      "id": 3256084,
      "avatar_url": "https://avatars1.githubusercontent.com/u/3256084?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ButzYung",
      "html_url": "https://github.com/ButzYung",
      "followers_url": "https://api.github.com/users/ButzYung/followers",
      "following_url": "https://api.github.com/users/ButzYung/following{/other_user}",
      "gists_url": "https://api.github.com/users/ButzYung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ButzYung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ButzYung/subscriptions",
      "organizations_url": "https://api.github.com/users/ButzYung/orgs",
      "repos_url": "https://api.github.com/users/ButzYung/repos",
      "events_url": "https://api.github.com/users/ButzYung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ButzYung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-07T16:28:33Z",
    "updated_at": "2017-03-07T16:28:33Z",
    "body": "@MarshallOfSound No. Just some hand-written JavaScript running on a prebuilt version of Electron."
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/284906883",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-284906883",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 284906883,
    "user": {
      "login": "kevinsawicki",
      "id": 671378,
      "avatar_url": "https://avatars0.githubusercontent.com/u/671378?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevinsawicki",
      "html_url": "https://github.com/kevinsawicki",
      "followers_url": "https://api.github.com/users/kevinsawicki/followers",
      "following_url": "https://api.github.com/users/kevinsawicki/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevinsawicki/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevinsawicki/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevinsawicki/subscriptions",
      "organizations_url": "https://api.github.com/users/kevinsawicki/orgs",
      "repos_url": "https://api.github.com/users/kevinsawicki/repos",
      "events_url": "https://api.github.com/users/kevinsawicki/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevinsawicki/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2017-03-08T00:31:55Z",
    "updated_at": "2017-03-08T00:31:55Z",
    "body": "@ButzYung are you setting up `electron` as a global somewhere? In your example I don't see where you assign `electron = require('electron)`.\r\n\r\nBoth of these examples work for me when running this file with `electron eval.js`:\r\n\r\n```js\r\neval(\r\n  \"const electron = require('electron');\\n\"\r\n+  \"const app = electron.app;\\n\"\r\n+ \"const BrowserWindow = electron.BrowserWindow;\\n\"\r\n+ \"app.on('ready', function() {\\n\"\r\n+ \"  mainWindow = new BrowserWindow();\\n\"\r\n+ \"});\"\r\n)\r\n```\r\n\r\n```js\r\nconst electron = require('electron')\r\n\r\neval(\r\n  \"const app = electron.app;\\n\"\r\n+ \"const BrowserWindow = electron.BrowserWindow;\\n\"\r\n+ \"app.on('ready', function() {\\n\"\r\n+ \"  mainWindow = new BrowserWindow();\\n\"\r\n+ \"});\"\r\n)\r\n```\r\n\r\nCan you include the entire file you are running the main process?"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/284973268",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-284973268",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 284973268,
    "user": {
      "login": "ButzYung",
      "id": 3256084,
      "avatar_url": "https://avatars1.githubusercontent.com/u/3256084?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ButzYung",
      "html_url": "https://github.com/ButzYung",
      "followers_url": "https://api.github.com/users/ButzYung/followers",
      "following_url": "https://api.github.com/users/ButzYung/following{/other_user}",
      "gists_url": "https://api.github.com/users/ButzYung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ButzYung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ButzYung/subscriptions",
      "organizations_url": "https://api.github.com/users/ButzYung/orgs",
      "repos_url": "https://api.github.com/users/ButzYung/repos",
      "events_url": "https://api.github.com/users/ButzYung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ButzYung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-08T08:01:24Z",
    "updated_at": "2017-03-08T08:01:24Z",
    "body": "I thought the above script was the mininal test case (which is not after actual test), but after some more testings, it seems the situation is more complicated.\r\n\r\nIn my actual app, the eval part is not directly parsing an inline string. Instead, it parses the content of an external file. The cause of the scope issue looks quite \"random\", and it seems to be related to the locations of some of those JavaScript comments. I have managed to create a minimal test case, but still I don't exactly know the cause. If I remove some comments here and there, the script would run.\r\n\r\nAnyways, here it is. Load the main script that contains the followings.\r\n\r\n```\r\nconst electron = require('electron')\r\nconst fs = require('fs')\r\neval(fs.readFileSync(__dirname + '\\\\zzz.txt').toString())\r\n```\r\n\r\nAnd inside the same folder, add the attached \"zzz.txt.\r\n\r\nRun it on Electron v1.6.2, and an error will occur saying \"BrowserWindow\" is undefined.\r\n\r\nPS: What's even more confusing is that if you convert the content of \"zzz.txt\" into an inline string and eval it directly, it will work.\r\n[zzz.txt](https://github.com/electron/electron/files/826980/zzz.txt)\r\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/284974298",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-284974298",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 284974298,
    "user": {
      "login": "enlight",
      "id": 233003,
      "avatar_url": "https://avatars3.githubusercontent.com/u/233003?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/enlight",
      "html_url": "https://github.com/enlight",
      "followers_url": "https://api.github.com/users/enlight/followers",
      "following_url": "https://api.github.com/users/enlight/following{/other_user}",
      "gists_url": "https://api.github.com/users/enlight/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/enlight/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/enlight/subscriptions",
      "organizations_url": "https://api.github.com/users/enlight/orgs",
      "repos_url": "https://api.github.com/users/enlight/repos",
      "events_url": "https://api.github.com/users/enlight/events{/privacy}",
      "received_events_url": "https://api.github.com/users/enlight/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-08T08:07:14Z",
    "updated_at": "2017-03-08T08:07:14Z",
    "body": "@ButzYung I'd suggest checking the encoding of the source file."
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/284974932",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-284974932",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 284974932,
    "user": {
      "login": "ButzYung",
      "id": 3256084,
      "avatar_url": "https://avatars1.githubusercontent.com/u/3256084?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ButzYung",
      "html_url": "https://github.com/ButzYung",
      "followers_url": "https://api.github.com/users/ButzYung/followers",
      "following_url": "https://api.github.com/users/ButzYung/following{/other_user}",
      "gists_url": "https://api.github.com/users/ButzYung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ButzYung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ButzYung/subscriptions",
      "organizations_url": "https://api.github.com/users/ButzYung/orgs",
      "repos_url": "https://api.github.com/users/ButzYung/repos",
      "events_url": "https://api.github.com/users/ButzYung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ButzYung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-08T08:10:41Z",
    "updated_at": "2017-03-08T08:10:41Z",
    "body": "@enlight It's a standard UTF-8 encoded document created in Notepadd++, nothing abnormal as far as I can see. The point is, the exact same script did run on older version of Electron (the last I tested was v1.4.15)."
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/284975064",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-284975064",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 284975064,
    "user": {
      "login": "MarshallOfSound",
      "id": 6634592,
      "avatar_url": "https://avatars0.githubusercontent.com/u/6634592?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarshallOfSound",
      "html_url": "https://github.com/MarshallOfSound",
      "followers_url": "https://api.github.com/users/MarshallOfSound/followers",
      "following_url": "https://api.github.com/users/MarshallOfSound/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarshallOfSound/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarshallOfSound/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarshallOfSound/subscriptions",
      "organizations_url": "https://api.github.com/users/MarshallOfSound/orgs",
      "repos_url": "https://api.github.com/users/MarshallOfSound/repos",
      "events_url": "https://api.github.com/users/MarshallOfSound/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarshallOfSound/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-08T08:11:27Z",
    "updated_at": "2017-03-08T08:11:27Z",
    "body": "@ButzYung Can you try\r\n\r\n```js\r\neval(fs.readFileSync(__dirname + '\\\\zzz.txt', 'utf8'))\r\n```\r\n\r\nJust to see what happens 👍 "
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/284976022",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-284976022",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 284976022,
    "user": {
      "login": "ButzYung",
      "id": 3256084,
      "avatar_url": "https://avatars1.githubusercontent.com/u/3256084?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ButzYung",
      "html_url": "https://github.com/ButzYung",
      "followers_url": "https://api.github.com/users/ButzYung/followers",
      "following_url": "https://api.github.com/users/ButzYung/following{/other_user}",
      "gists_url": "https://api.github.com/users/ButzYung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ButzYung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ButzYung/subscriptions",
      "organizations_url": "https://api.github.com/users/ButzYung/orgs",
      "repos_url": "https://api.github.com/users/ButzYung/repos",
      "events_url": "https://api.github.com/users/ButzYung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ButzYung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-08T08:16:32Z",
    "updated_at": "2017-03-08T08:16:32Z",
    "body": "@MarshallOfSound  Tested, but it didn't change anything. The script would still return an error at the same point saying BrowserWindow is not defined."
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/285027138",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-285027138",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 285027138,
    "user": {
      "login": "pronebird",
      "id": 704044,
      "avatar_url": "https://avatars1.githubusercontent.com/u/704044?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pronebird",
      "html_url": "https://github.com/pronebird",
      "followers_url": "https://api.github.com/users/pronebird/followers",
      "following_url": "https://api.github.com/users/pronebird/following{/other_user}",
      "gists_url": "https://api.github.com/users/pronebird/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pronebird/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pronebird/subscriptions",
      "organizations_url": "https://api.github.com/users/pronebird/orgs",
      "repos_url": "https://api.github.com/users/pronebird/repos",
      "events_url": "https://api.github.com/users/pronebird/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pronebird/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-08T12:22:39Z",
    "updated_at": "2017-03-08T12:23:48Z",
    "body": "@ButzYung I looked at your zzz.txt and I would suggest to put `;` at the end of statements, cuz you know, javascript.. That explains to me why removing comments changes the script's behavior."
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/302844238",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-302844238",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 302844238,
    "user": {
      "login": "albinekb",
      "id": 5027156,
      "avatar_url": "https://avatars2.githubusercontent.com/u/5027156?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/albinekb",
      "html_url": "https://github.com/albinekb",
      "followers_url": "https://api.github.com/users/albinekb/followers",
      "following_url": "https://api.github.com/users/albinekb/following{/other_user}",
      "gists_url": "https://api.github.com/users/albinekb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/albinekb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/albinekb/subscriptions",
      "organizations_url": "https://api.github.com/users/albinekb/orgs",
      "repos_url": "https://api.github.com/users/albinekb/repos",
      "events_url": "https://api.github.com/users/albinekb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/albinekb/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-20T02:07:31Z",
    "updated_at": "2017-05-20T02:07:31Z",
    "body": "I think this is relevant, https://github.com/webpack/webpack/issues/2145 🤔 "
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/308067536",
    "html_url": "https://github.com/electron/electron/issues/8854#issuecomment-308067536",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/8854",
    "id": 308067536,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2017-06-13T09:58:08Z",
    "updated_at": "2017-06-13T09:58:08Z",
    "body": "I'm closing this since it is a problem caused by the update of V8 or Node.js, you have to find out the root cause yourself and report it to V8 or Node.js, we are unable to fix this on Electron's side."
  }
]