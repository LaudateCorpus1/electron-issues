[
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/225497393",
    "html_url": "https://github.com/electron/electron/issues/6009#issuecomment-225497393",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/6009",
    "id": 225497393,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2016-06-13T06:18:18Z",
    "updated_at": "2016-06-13T06:18:18Z",
    "body": "Can you provide a minimal app that can reproduce this problem?\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/225513779",
    "html_url": "https://github.com/electron/electron/issues/6009#issuecomment-225513779",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/6009",
    "id": 225513779,
    "user": {
      "login": "kenan2002",
      "id": 2618847,
      "avatar_url": "https://avatars1.githubusercontent.com/u/2618847?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kenan2002",
      "html_url": "https://github.com/kenan2002",
      "followers_url": "https://api.github.com/users/kenan2002/followers",
      "following_url": "https://api.github.com/users/kenan2002/following{/other_user}",
      "gists_url": "https://api.github.com/users/kenan2002/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kenan2002/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kenan2002/subscriptions",
      "organizations_url": "https://api.github.com/users/kenan2002/orgs",
      "repos_url": "https://api.github.com/users/kenan2002/repos",
      "events_url": "https://api.github.com/users/kenan2002/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kenan2002/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-13T08:05:55Z",
    "updated_at": "2016-06-13T08:05:55Z",
    "body": "``` html\n<a href=\"data:text/plain,hello%20world\" download=\"a.txt\">click to download</a>\n<script>\n  const {remote} = require('electron');\n  const {session} = remote.require('electron');\n\n  session.defaultSession.on('will-download', (event, item, webContents) => {\n    // This line *sometimes* doesn't work\n    item.setSavePath('C:\\\\temp\\\\b.txt');\n  });\n</script>\n```\n\nThis does not always trigger the bug. Try multiple times.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/225514865",
    "html_url": "https://github.com/electron/electron/issues/6009#issuecomment-225514865",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/6009",
    "id": 225514865,
    "user": {
      "login": "kenan2002",
      "id": 2618847,
      "avatar_url": "https://avatars1.githubusercontent.com/u/2618847?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kenan2002",
      "html_url": "https://github.com/kenan2002",
      "followers_url": "https://api.github.com/users/kenan2002/followers",
      "following_url": "https://api.github.com/users/kenan2002/following{/other_user}",
      "gists_url": "https://api.github.com/users/kenan2002/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kenan2002/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kenan2002/subscriptions",
      "organizations_url": "https://api.github.com/users/kenan2002/orgs",
      "repos_url": "https://api.github.com/users/kenan2002/repos",
      "events_url": "https://api.github.com/users/kenan2002/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kenan2002/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-13T08:11:37Z",
    "updated_at": "2016-06-13T08:11:37Z",
    "body": "What I want to do is to call `dialog.showSaveDialog()` before setSavePath(), which will cause the app to prompt save dialog twice. I do this to achieve what #5877 should fix.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/225519794",
    "html_url": "https://github.com/electron/electron/issues/6009#issuecomment-225519794",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/6009",
    "id": 225519794,
    "user": {
      "login": "kenan2002",
      "id": 2618847,
      "avatar_url": "https://avatars1.githubusercontent.com/u/2618847?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kenan2002",
      "html_url": "https://github.com/kenan2002",
      "followers_url": "https://api.github.com/users/kenan2002/followers",
      "following_url": "https://api.github.com/users/kenan2002/following{/other_user}",
      "gists_url": "https://api.github.com/users/kenan2002/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kenan2002/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kenan2002/subscriptions",
      "organizations_url": "https://api.github.com/users/kenan2002/orgs",
      "repos_url": "https://api.github.com/users/kenan2002/repos",
      "events_url": "https://api.github.com/users/kenan2002/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kenan2002/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-13T08:35:52Z",
    "updated_at": "2016-06-13T08:37:27Z",
    "body": "I think the default save dialog should prompt **after** the whole \"will-download\" callback ends to avoid this issue. Or the \"will-download\" event can be split into two events, say \"before-download\" and \"will-download\". In \"before-download\" we can set the save path and in \"will-download\" we do the rest. For example:\n\n```\nsession.defaultSession.on('before-download', (event, item, webContents) => {\n    item.setSavePath('C:\\\\temp\\\\b.txt');\n});\nsession.defaultSession.on('will-download', (event, item, webContents) => {\n    // other stuff...\n});\n```\n\nIn addition, with the \"before-download\" event, if the default dialog is cancelled or event.preventDefault() is called, the \"will-download\" should never trigger. This gives us a chance to check whether save dialog was cancelled without calling item.isDestroyed().\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/225527169",
    "html_url": "https://github.com/electron/electron/issues/6009#issuecomment-225527169",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/6009",
    "id": 225527169,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2016-06-13T09:08:51Z",
    "updated_at": "2016-06-13T09:08:51Z",
    "body": "You have to listen to the event in the main process if you want to call `setSavePath`. This API has to be called immediately when `will-download` event is emitted, while the event is sent to the renderer process asynchronously.\n"
  }
]