[
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/63932940",
    "html_url": "https://github.com/electron/electron/issues/846#issuecomment-63932940",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/846",
    "id": 63932940,
    "user": {
      "login": "rprichard",
      "id": 1572855,
      "avatar_url": "https://avatars0.githubusercontent.com/u/1572855?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rprichard",
      "html_url": "https://github.com/rprichard",
      "followers_url": "https://api.github.com/users/rprichard/followers",
      "following_url": "https://api.github.com/users/rprichard/following{/other_user}",
      "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions",
      "organizations_url": "https://api.github.com/users/rprichard/orgs",
      "repos_url": "https://api.github.com/users/rprichard/repos",
      "events_url": "https://api.github.com/users/rprichard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rprichard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-21T07:19:26Z",
    "updated_at": "2014-11-21T07:19:26Z",
    "body": "FWIW: I hit this problem because I had code in a renderer process that regenerated a menu by first clearing it, the repopulating it.  There was a tiny window between the Menu.clear RPC and the Menu.append RPC where the program could crash.  My workaround is to update the menu more atomically, in the browser process.  (For now, I have a function in the browser process that clears the menu and calls Window.setMenu to clear the menu's accelerator registrations.)\n\nI _think_ this avoids the problem.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/64063998",
    "html_url": "https://github.com/electron/electron/issues/846#issuecomment-64063998",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/846",
    "id": 64063998,
    "user": {
      "login": "rprichard",
      "id": 1572855,
      "avatar_url": "https://avatars0.githubusercontent.com/u/1572855?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rprichard",
      "html_url": "https://github.com/rprichard",
      "followers_url": "https://api.github.com/users/rprichard/followers",
      "following_url": "https://api.github.com/users/rprichard/following{/other_user}",
      "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions",
      "organizations_url": "https://api.github.com/users/rprichard/orgs",
      "repos_url": "https://api.github.com/users/rprichard/repos",
      "events_url": "https://api.github.com/users/rprichard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rprichard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-22T01:57:41Z",
    "updated_at": "2014-11-22T01:57:41Z",
    "body": "My first workaround didn't work, because calling `Window.setMenu` when the menu is open leads to segfaults, on both Windows and Linux.  I've adjusted my workaround to instead clear and repopulate the menu in a single function call in the browser process.\n\nI almost wanted to use `Menu.buildFromTemplate`, but that doesn't quite do what I need, in a couple of ways:\n- Because changing an existing `MenuItem`'s `submenu` property has no effect, I need to repopulate an existing `Menu` object, rather than create a new one.\n- I need to keep track of the `MenuItem` objects I create, so I can update them later (e.g. the `checked` property).\n\nI wrote my own `populateMenuFromTemplate` function that solved these issues.\n\nFWIW, I also noticed that if I alter the menubar's `Menu` object (clearing or appending), the Linux/Windows menubar is not updated until I call `Window.setMenu`, and before it's updated, the program can crash (assert failure).  But because calling `Window.setMenu` also invites crashes, it's very difficult (or impossible) to safely alter the menubar.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/64149958",
    "html_url": "https://github.com/electron/electron/issues/846#issuecomment-64149958",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/846",
    "id": 64149958,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2014-11-24T03:51:00Z",
    "updated_at": "2014-11-24T03:51:00Z",
    "body": "The proper way in atom-shell to update menu bar or application menu is to call `BrowserWindow.setMenu` or `app.setApplicationMenu` after you modified `Menu` object every time.\n\nThis is because `Menu` actually acts as a **model**, and the native menu is not created until you call `setMenu`, so if you change the model without updating the native menu, bad things can happen. We use this design because it perfectly represents the menu library used by Chromium, and most menus are static.\n\nBut I think we should find a way to prevent the crash and make it clear in documents.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/64165370",
    "html_url": "https://github.com/electron/electron/issues/846#issuecomment-64165370",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/846",
    "id": 64165370,
    "user": {
      "login": "rprichard",
      "id": 1572855,
      "avatar_url": "https://avatars0.githubusercontent.com/u/1572855?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rprichard",
      "html_url": "https://github.com/rprichard",
      "followers_url": "https://api.github.com/users/rprichard/followers",
      "following_url": "https://api.github.com/users/rprichard/following{/other_user}",
      "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions",
      "organizations_url": "https://api.github.com/users/rprichard/orgs",
      "repos_url": "https://api.github.com/users/rprichard/repos",
      "events_url": "https://api.github.com/users/rprichard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rprichard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-24T08:49:39Z",
    "updated_at": "2014-11-24T08:49:39Z",
    "body": "That makes sense.\n\nFWIW, I created a separate issue describing the crash I get when I _do_ call `BrowserWindow.setMenu`.  https://github.com/atom/atom-shell/issues/859\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/217368859",
    "html_url": "https://github.com/electron/electron/issues/846#issuecomment-217368859",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/846",
    "id": 217368859,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2016-05-06T07:19:55Z",
    "updated_at": "2016-05-06T07:19:55Z",
    "body": "I'm closing this since we don't support changing menu object after calling `setMenu`, the behavior is undefined if user does that.\n"
  }
]